<!DOCTYPE html>
<html lang="en" ng-app="vtoureApp">
    <head>
        <meta charset="utf-8">
        <title>Vtoure</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="">
        <meta name="author" content="">
        <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
        <link rel="stylesheet" href="stylesheets/main.css">
    
    </head>

    <body ng-controller="vtoureCtrl" id="vtoureApp">
        <div style="background-image: url(photoshop/logo.png); width: 600px; height: 70px;">
            <div class="topprofile animate-show" ng-hide="person.first_name === undefined" ng-cloak>
                <img src="" ng-src="{{person.photo_50}}" class="img-rounded  pull-left" style="margin-right: 10px">
                <div class="namebox"><small>
                         <b>{{ person.first_name +  " " + person.last_name }}</b>
                         <!--, найдено <b>{{ person.counters.audios }}</b> звукозаписей.-->
                     </small>
                </div>
                <div class="small"><span class="glyphicon glyphicon-map-marker"></span> Поиск концертов в <b>{{location.name}}</b></div>
            </div>
        </div>
        
        <img class="mainborder" src="http://maps.googleapis.com/maps/api/staticmap?center={{location.lat}},{{location.lon}}&zoom=10&size=598x180&maptype=roadmap&sensor=false&style=hue:0x007fff|saturation:-56&markers=icon:http://cdima.github.io/vtoure/photoshop/icon_1832_20px.png%7C{{location.lat}},{{location.lon}}"  />
        <div class="container-fluid mainborder paddingtop">
            <div class="row">
                <div class="col-md-12">
                    <div class="well well-sm" id="permissionsAlert" ng-hide="window.permissionsGranted"  ng-cloak>
                        <div class="text-default">Приложению нужен доступ к аудио записям. <button id="audiopermissions" class="btn btn-primary btn-xs">разрешить доступ к аудио</button></div>
                    </div>
                    <div>
                        <p class="form-group"  ng-class="{'has-error': !locationNameValid}" >
                            <span class="small">Поиск заточен под крупные города, искать в другом месте:</span>
                            <input type="text" class="form-control input-sm inputtown"placeholder="Нью Йорк" ng-model="locationName" />
                            <button type="submit" class="btn btn-default btn-sm inputtown" ng-click="onChangeLocation()"><span class="glyphicon glyphicon-map-marker"></span> Искать</button>
                        </p>
                    </div>
                    
                    <div class="progress progress-striped active" 
                         id="artistsProgressbar" 
                         ng-hide="(progressCount == 0 || progressCount == artists.length)" ng-cloak>
                        <div class="progress-bar"  
                             role="progressbar" 
                             aria-valuenow="{{progressCount}}" 
                             aria-valuemin="0" 
                             aria-valuemax="{{artists.length}}" 
                             style="width: {{(100 * progressCount / artists.length)}}%">
                            {{progressCount}} / {{artists.length}}
                        </div>
                    </div>
                    
                    <!--
                        <p class="btn-group btn-group-sm">
                            <button type="button" class="btn btn-default" ng-class="{active: !filterByArtists}">Все концерты</button>
                            <button type="button" class="btn btn-default" ng-class="{active: filterByArtists}">Мои исполнители ({{artists.length}})</button>
                        </p>    

                        <p>
                            <span class="small">Искать исполнителя: </span>
                            <input type="text" class="form-control input-sm inputtown" placeholder="The Glitch Mob" ng-model="artistFilterName" />
                            <button type="submit" class="btn btn-default btn-sm inputtown" ng-click="onFilterArtist()"><span class="glyphicon glyphicon-map-marker"></span> Искать</button>
                        </p>-->
                            
                    

                    <div class="panel panel-info" id="artists-ng" ng-hide="(artists.length == 0)" ng-cloak>
                        <div class="panel-heading">Выступающие исполнители (всего {{artists.length}})</div>
                        <div class="panel-body">
                            <span ng-repeat="artist in artists" ng-hide="(artist.queriedEvents && artist.events.length == 0)">
                                <span class="label" 
                                      ng-class="{'label-primary': (artist.queriedEvents && artist.events.length > 0), 'label-default': (artist.queriedEvents && artist.events.length == 0), 'label-info': (!artist.queriedEvents)}">
                                    {{artist.displayName}} <!-- <span ng-hide="artist.events.length == 0">{{artist.events.length}}</span> -->
                                </span>
                                &nbsp; <!-- space formatting -->
                            </span>
                        </div>
                    </div>
                                        
                    <div class="panel panel-primary"  ng-hide="(events.length == 0)" ng-cloak>
                        <div class="panel-heading">Найдено концертов <b>{{events.length}}</b></div>
                        <div class="panel-body">
                            <div class="media" ng-repeat="event in events|orderBy:'start.date'">
                                <a class="pull-left" href="{{event.uri}}" target="_blank">
                                    <div style="background-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2NCIgaGVpZ2h0PSI2NCI+PHJlY3Qgd2lkdGg9IjY0IiBoZWlnaHQ9IjY0IiBmaWxsPSIjZWVlIj48L3JlY3Q+PHRleHQgdGV4dC1hbmNob3I9Im1pZGRsZSIgeD0iMzIiIHk9IjMyIiBzdHlsZT0iZmlsbDojYWFhO2ZvbnQtd2VpZ2h0OmJvbGQ7Zm9udC1zaXplOjEycHg7Zm9udC1mYW1pbHk6QXJpYWwsSGVsdmV0aWNhLHNhbnMtc2VyaWY7ZG9taW5hbnQtYmFzZWxpbmU6Y2VudHJhbCI+NjR4NjQ8L3RleHQ+PC9zdmc+); width: 64px; height: 64px;margin-right: 10px; max-height: 64px; max-width:64px;"  >
                                        <img 
                                            id="concertimg" 
                                            class="img-rounded media-object" 
                                            ng-src="https://ssl.sk-static.com/images/media/profile_images/venues/{{event.venue.id}}/col1" 
                                            ng-onerror="this.src='https://ssl.sk-static.com/images/media/profile_images/artists/{{event.venue.id}}/col1';"    
                                            style="width: 64px; height: 64px;margin-right: 10px; max-height: 64px; max-width:64px;" />
                                    </div>
                                </a>
                                <div class="media-body">
                                    <h4 class="media-heading">{{event.foundByArtist.displayName}}</h4>
                                    <b>{{event.start.date | date:'MMM d, y'}} {{event.start.time | date:' h a'}}</b>
                                    <a href="{{event.uri}}" target="_blank">{{event.displayName}}</a> @ 
                                    <a href="{{event.venue.uri}}" target="_blank">{{event.venue.displayName}}</a> {{event.location.city}}
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="panel panel-default hidden" ng-cloak>
                        <div id="preview" class="panel-body small pre-scrollable"></div>
                    </div>
                    
                    <br />
                    
                    <div class="panel panel-default"  ng-cloak>
                      <div class="panel-heading">Debug log</div>
                      <div class="panel-body">
                        <small>Приложение находится в стадии разработки, ниже лог приложения.</small>
                        <div id="log" class="panel-body small pre-scrollable"></div>
                      </div>
                    </div>
                </div>
            </div>
        </div> <!-- container -->
        
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
        <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.2.15/angular.min.js"></script>
        <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.2.15/angular-animate.min.js"></script>
        <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.2.15/angular-cookies.min.js"></script>
        <script src="resources/angular/angularLocalStorage.js" type="text/javascript"></script>
        <script src="resources/bootstrap/js/bootstrap.min.js"></script>
        <!--<script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>-->
        <script src="//vk.com/js/api/xd_connection.js?2" type="text/javascript"></script>
        <script src="javascript/global.js" type="text/javascript"></script>
        <script src="javascript/songkick.js" type="text/javascript"></script>
        <script src="http://ip-api.com/json/?callback=getLocation" type="text/javascript"></script>
        <script src="javascript/vtoure.js" type="text/javascript"></script>
        <script src="javascript/controllers.js" type="text/javascript"></script>
        
        <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false"></script>
        
        <!-- google analytics -->
        <script>
            (function (i, s, o, g, r, a, m) {
                i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
                    (i[r].q = i[r].q || []).push(arguments)
                }, i[r].l = 1 * new Date(); a = s.createElement(o),
                    m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
            })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

            ga('create', 'UA-49615490-1', 'cdima.github.io');
            ga('send', 'pageview');
        </script>
        <!-- double click -->
        <script type="text/javascript">
            var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-49615490-1']);
            _gaq.push(['_trackPageview']);
            (function () {
                var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
            })();
        </script>
        <!-- Yandex.Metrika counter -->
        <script type="text/javascript">(function (d, w, c) { (w[c] = w[c] || []).push(function () { try { w.yaCounter24510557 = new Ya.Metrika({ id: 24510557, webvisor: true, clickmap: true, trackLinks: true, accurateTrackBounce: true, trackHash: true }); } catch (e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript><div><img src="//mc.yandex.ru/watch/24510557" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
    </body>
</html>